(this.webpackJsonptrybetunes=this.webpackJsonptrybetunes||[]).push([[0],{31:function(e,t,n){},42:function(e,t,n){},43:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),i=n(24),s=n.n(i),c=(n(31),n(4)),o=n(5),u=n(6),l=n(7),d=n(16),j=n(3),b=n(8),p=n(15),m=n(2),h=n.n(m),f=n(10),O="user",v=function(e){return localStorage.setItem(O,JSON.stringify(e))},g=function(e){return function(t){return t(e)}},x=function(){return new Promise((function(e){var t=JSON.parse(localStorage.getItem(O));null===t&&(t={}),g(t)(e)}))},N=function(e){return new Promise((function(t){v(Object(f.a)(Object(f.a)({},{name:"",email:"",image:"",description:""}),e)),g("OK")(t)}))},k=function(e){return new Promise((function(t){v(Object(f.a)({},e)),g("OK")(t)}))},L=n(0),S=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(L.jsx)("div",{className:"loading",children:Object(L.jsx)("p",{children:"Carregando..."})})}}]),n}(a.Component),y=S,w=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).onChange=function(t){var n=t.target,a=n.className,r=n.value;e.setState(Object(p.a)({},a,r))},e.onSubmit=function(){var t=Object(b.a)(h.a.mark((function t(n){var a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.state.name,n.preventDefault(),e.setState({isLoading:!0}),t.next=5,N({name:a});case 5:e.setState({isLoading:!1,isUser:!0});case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.isNameValid=function(){return e.state.name.length>=3},e.state={name:"",isLoading:!1,isUser:!1},e}return Object(o.a)(n,[{key:"render",value:function(){var e=this.state,t=e.name,n=e.isLoading,a=e.isUser,r=this.onChange,i=this.onSubmit,s=this.isNameValid;return Object(L.jsxs)("div",{"data-testid":"page-login",className:"page-login",children:[a?Object(L.jsx)(j.a,{to:"/search"}):null,n?Object(L.jsx)(y,{}):Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)("img",{src:"./assets/logo.png",alt:"logo",className:"logo"}),Object(L.jsxs)("form",{className:"login-form",children:[Object(L.jsx)("input",{type:"text",onChange:r,value:t,className:"name","data-testid":"login-name-input",placeholder:"Nome"}),Object(L.jsx)("button",{type:"submit","data-testid":"login-submit-button",disabled:!s(),onClick:i,children:"Entrar"})]})]})]})}}]),n}(a.Component),C=w,I=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e=this.props,t=e.artistName,n=e.collectionName,a=e.artworkUrl100,r=e.collectionId;return Object(L.jsx)(d.b,{to:"/album/".concat(r),"data-testid":"link-to-album-".concat(r),className:"album-cover",children:Object(L.jsxs)("div",{children:[Object(L.jsx)("img",{src:a,alt:"album-cover"}),Object(L.jsx)("p",{"data-testid":"album-name",children:n}),Object(L.jsx)("p",{"data-testid":"artist-name",children:t})]})})}}]),n}(a.Component),F=I,M=function(){var e=Object(b.a)(h.a.mark((function e(t){var n,a,r,i,s,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=encodeURI(t).replaceAll("%20","+"),a="https://itunes.apple.com/search?entity=album&term=".concat(n,"&attribute=allArtistTerm"),e.next=4,fetch(a);case 4:return r=e.sent,e.next=7,r.json();case 7:return i=e.sent,s=i.results,c=s.map((function(e){return{artistId:e.artistId,artistName:e.artistName,collectionId:e.collectionId,collectionName:e.collectionName,collectionPrice:e.collectionPrice,artworkUrl100:e.artworkUrl100,releaseDate:e.releaseDate,trackCount:e.trackCount}})),e.abrupt("return",c);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=M,U=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).onChange=function(t){var n=t.target,a=n.className,r=n.value;e.setState(Object(p.a)({},a,r))},e.onSubmit=function(){var t=Object(b.a)(h.a.mark((function t(n){var a,r,i;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),e.handleLoading(),a=e.state.name,t.next=5,P(a);case 5:r=t.sent,i=r.length>0,e.setState({name:"",result:{status:i,name:a,albums:r}}),e.handleLoading();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.isNameValid=function(){return e.state.name.length>=2},e.handleLoading=function(){return e.setState((function(e){return{isLoading:!e.isLoading}}))},e.state={name:"",isLoading:!1,result:{status:void 0,name:"",albums:[]}},e}return Object(o.a)(n,[{key:"render",value:function(){var e=this.state,t=e.name,n=e.isLoading,a=e.result,r=a.status,i=a.name,s=a.albums,c=this.onChange,o=this.onSubmit,u=this.isNameValid;return Object(L.jsxs)("div",{"data-testid":"page-search",className:"page-search",children:[n?Object(L.jsx)(y,{}):Object(L.jsxs)("form",{className:"search-form",children:[Object(L.jsx)("h2",{children:"Pesquisar"}),Object(L.jsx)("input",{type:"text",onChange:c,value:t,className:"name","data-testid":"search-artist-input",placeholder:"Artista, alb\xfam ou banda..."}),Object(L.jsx)("button",{type:"submit","data-testid":"search-artist-button",disabled:!u(),onClick:o,children:"Pesquisar"})]}),r?Object(L.jsxs)("h2",{children:["Resultado de \xe1lbuns de:"," ",i]}):void 0!==r&&Object(L.jsx)("p",{children:"Nenhum \xe1lbum foi encontrado"}),Object(L.jsx)("div",{className:"search-result",children:s.map((function(e,t){return Object(L.jsx)(F,Object(f.a)({},e),t)}))})]})}}]),n}(a.Component),D=U,J=n(20),V=function(){var e=Object(b.a)(h.a.mark((function e(t){var n,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://itunes.apple.com/lookup?id=".concat(t,"&entity=song"));case 2:return n=e.sent,e.next=5,n.json();case 5:return a=e.sent,e.abrupt("return",a.results);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=V,K="favorite_songs";JSON.parse(localStorage.getItem(K))||localStorage.setItem(K,JSON.stringify([]));var z=function(){return JSON.parse(localStorage.getItem(K))},A=function(e){return localStorage.setItem(K,JSON.stringify(e))},q=function(e){return function(t){return t(e)}},R=function(){return new Promise((function(e){var t=z();q(t)(e)}))},B=function(e){return new Promise((function(t){if(e){var n=z();A([].concat(Object(J.a)(n),[e]))}q("OK")(t)}))},T=function(e){return new Promise((function(t){var n=z();A(n.filter((function(t){return t.trackId!==e.trackId}))),q("OK")(t)}))},$=n(14),_=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.trackId,a=t.trackName,r=t.previewUrl,i=t.handleFavorite,s=t.isFavorite;return Object(L.jsxs)("div",{children:[Object(L.jsx)("p",{children:a}),Object(L.jsxs)("audio",{"data-testid":"audio-component",src:r,controls:!0,children:[Object(L.jsx)("track",{kind:"captions"}),"O seu navegador n\xe3o suporta o elemento"," ",Object(L.jsx)("code",{children:"audio"}),"."]}),Object(L.jsxs)("label",{htmlFor:n,className:"favorite-input",children:[Object(L.jsx)("input",{type:"checkbox",id:n,"data-testid":"checkbox-music-".concat(n),onChange:function(){return i(e.props)},checked:s(a)}),"Favorita"]}),s(a)?Object(L.jsx)($.a,{onClick:function(){return i(e.props)},className:"favorited-icon"}):Object(L.jsx)($.b,{onClick:function(){return i(e.props)},className:"favorite-icon"})]})}}]),n}(a.Component),G=_,H=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).componentDidMount=Object(b.a)(h.a.mark((function t(){var n,a,r,i;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.handleLoading(),n=e.props.match,a=n.params.id,t.next=5,E(a);case 5:return r=t.sent,t.next=8,R();case 8:i=t.sent,e.handleMusics(r,i),e.handleLoading();case 11:case"end":return t.stop()}}),t)}))),e.handleLoading=function(){return e.setState((function(e){return{isLoading:!e.isLoading}}))},e.handleMusics=function(t,n){var a=Object(J.a)(t),r=a.shift();e.setState({albumInfo:r,musics:a,favMusics:n})},e.isFavorite=function(t){var n=e.state.favMusics;return void 0!==n&&n.length>0&&!!n.find((function(e){return e.trackName===t}))},e.handleFavorite=function(){var t=Object(b.a)(h.a.mark((function t(n){var a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.handleLoading(),!(a=e.state.favMusics).some((function(e){return e.trackName===n.trackName}))){t.next=8;break}return a=a.filter((function(e){return e.trackName!==n.trackName})),t.next=6,T(n);case 6:t.next=11;break;case 8:return a.push(n),t.next=11,B(n);case 11:e.setState({favMusics:a}),e.handleLoading();case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.state={albumInfo:void 0,musics:[],favMusics:[],isLoading:!1},e}return Object(o.a)(n,[{key:"render",value:function(){var e=this.state,t=e.musics,n=e.albumInfo,a=e.isLoading,r=this.handleFavorite,i=this.isFavorite;return Object(L.jsx)("div",{"data-testid":"page-album",className:"page-album",children:a?Object(L.jsx)(y,{}):Object(L.jsxs)(L.Fragment,{children:[n&&Object(L.jsx)(F,Object(f.a)({},n)),Object(L.jsx)("div",{className:"album-musics",children:t.map((function(e,t){return Object(L.jsx)(G,Object(f.a)(Object(f.a)({},e),{},{handleFavorite:r,isFavorite:i}),t)}))})]})})}}]),n}(a.Component),Q=H,W=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).componentDidMount=Object(b.a)(h.a.mark((function t(){var n;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.handleLoading(),t.next=3,R();case 3:n=t.sent,e.handleMusics(n),e.handleLoading();case 6:case"end":return t.stop()}}),t)}))),e.handleMusics=function(t){return e.setState({favMusics:t})},e.handleLoading=function(){return e.setState((function(e){return{isLoading:!e.isLoading}}))},e.handleFavorite=function(){var t=Object(b.a)(h.a.mark((function t(n){var a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.handleLoading(),a=(a=e.state.favMusics).filter((function(e){return e.trackName!==n.trackName})),e.setState({favMusics:a}),t.next=6,T(n);case 6:e.handleLoading();case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.state={isLoading:!1,favMusics:[]},e}return Object(o.a)(n,[{key:"render",value:function(){var e=this.state,t=e.favMusics,n=e.isLoading,a=this.handleFavorite;return Object(L.jsx)("div",{"data-testid":"page-favorites",className:"page-favorites",children:n?Object(L.jsx)(y,{}):Object(L.jsx)(L.Fragment,{children:t.map((function(e,t){return Object(L.jsx)(G,Object(f.a)(Object(f.a)({},e),{},{isFavorite:function(){return!0},handleFavorite:a}),t)}))})})}}]),n}(a.Component),X=W,Y=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).componentDidMount=Object(b.a)(h.a.mark((function t(){var n;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.handleLoading(),t.next=3,x();case 3:n=t.sent,e.handleUser(n),e.handleLoading();case 6:case"end":return t.stop()}}),t)}))),e.handleUser=function(t){return e.setState({user:t})},e.handleLoading=function(){return e.setState((function(e){return{isLoading:!e.isLoading}}))},e.state={user:"",isLoading:!1},e}return Object(o.a)(n,[{key:"render",value:function(){var e=this.state,t=e.user,n=t.name,a=t.email,r=t.image,i=t.description,s=e.isLoading;return Object(L.jsx)("div",{"data-testid":"page-profile",className:"page-profile",children:s?Object(L.jsx)(y,{}):Object(L.jsxs)("div",{className:"profile-info",children:[Object(L.jsxs)("div",{children:[r?Object(L.jsx)("img",{src:r,alt:"profile",className:"profile-image","data-testid":"profile-image"}):Object(L.jsx)($.c,{className:"profile-image"}),Object(L.jsx)("button",{type:"button",className:"edit-profile-button",children:Object(L.jsx)(d.b,{to:"/profile/edit",children:"Editar perfil"})})]}),Object(L.jsx)("p",{children:"Name:"}),Object(L.jsx)("p",{className:"profile-small",children:n}),Object(L.jsx)("p",{children:"E-mail:"}),Object(L.jsx)("p",{className:"profile-small",children:a}),Object(L.jsx)("p",{children:"Description:"}),Object(L.jsx)("p",{className:"profile-small",children:i})]})})}}]),n}(a.Component),Z=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).componentDidMount=Object(b.a)(h.a.mark((function t(){var n;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.handleLoading(),t.next=3,x();case 3:n=t.sent,e.handleUser(n),e.handleLoading();case 6:case"end":return t.stop()}}),t)}))),e.handleUser=function(t){return e.setState({user:t})},e.handleLoading=function(){return e.setState((function(e){return{isLoading:!e.isLoading}}))},e.areFieldsValid=function(){var t=e.state.user,n=!Object.values(t).some((function(e){return""===e})),a=/^[a-z0-9]*@[a-z0-9]*[.][a-z]{2,3}$/i.test(t.email);return!(!n||!a)},e.onChange=function(t){var n=t.target,a=n.name,r=n.value;return e.setState((function(e){return{user:Object(f.a)(Object(f.a)({},e.user),{},Object(p.a)({},a,r))}}))},e.onSubmit=function(){var t=Object(b.a)(h.a.mark((function t(n){var a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),e.handleLoading(),a=e.state.user,t.next=5,k(a);case 5:e.handleLoading(),e.setState({isSubmit:!0});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.state={user:{},isLoading:!1,isSubmit:!1},e}return Object(o.a)(n,[{key:"render",value:function(){var e=this.state,t=e.user,n=t.name,a=t.email,r=t.image,i=t.description,s=e.isLoading,c=e.isSubmit,o=this.onChange,u=this.onSubmit,l=this.areFieldsValid;return Object(L.jsxs)("div",{"data-testid":"page-profile-edit",className:"page-profile-edit",children:[s?Object(L.jsx)(y,{}):Object(L.jsxs)("form",{children:[Object(L.jsxs)("div",{children:[r?Object(L.jsx)("img",{src:r,alt:"profile",className:"profile-image","data-testid":"profile-image"}):Object(L.jsx)($.c,{className:"profile-image"}),Object(L.jsx)("input",{type:"text","data-testid":"edit-input-image",name:"image",onChange:o,value:r})]}),Object(L.jsx)("p",{children:"Nome:"}),Object(L.jsx)("p",{children:Object(L.jsx)("input",{type:"text","data-testid":"edit-input-name",name:"name",onChange:o,value:n})}),Object(L.jsx)("p",{children:"E-mail:"}),Object(L.jsx)("p",{children:Object(L.jsx)("input",{type:"email","data-testid":"edit-input-email",name:"email",onChange:o,value:a})}),Object(L.jsx)("p",{children:"Descri\xe7\xe3o:"}),Object(L.jsx)("p",{children:Object(L.jsx)("input",{type:"text","data-testid":"edit-input-description",name:"description",onChange:o,value:i})}),Object(L.jsx)("button",{type:"submit","data-testid":"edit-button-save",onClick:u,disabled:!l(),children:"Salvar"})]}),c?Object(L.jsx)(j.a,{to:"/profile"}):null]})}}]),n}(a.Component),ee=Z,te=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(L.jsx)("div",{"data-testid":"page-not-found",children:Object(L.jsx)("p",{children:"Not Found"})})}}]),n}(a.Component),ne=te,ae=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).componentDidMount=Object(b.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.handleLoading(),t.next=3,e.searchUser();case 3:e.handleLoading();case 4:case"end":return t.stop()}}),t)}))),e.handleLoading=function(){return e.setState((function(e){return{isLoading:!e.isLoading}}))},e.searchUser=Object(b.a)(h.a.mark((function t(){var n;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x();case 2:n=t.sent,e.setState({user:n});case 4:case"end":return t.stop()}}),t)}))),e.isCurrent=function(t){var n=e.props.currentPage,a=e.state.isInnerPage,r=n.split("/");return r[2]&&!a&&e.setState({isInnerPage:!0}),r[1]===t?"selected":""},e.state={user:{},isLoading:!1,isInnerPage:!1},e}return Object(o.a)(n,[{key:"render",value:function(){var e=this.state,t=e.user,n=t.name,a=t.image,r=e.isLoading,i=e.isInnerPage,s=this.isCurrent;return Object(L.jsx)("div",{"data-testid":"header-component",children:r?Object(L.jsx)(y,{}):Object(L.jsxs)("header",{children:[Object(L.jsxs)("div",{children:[Object(L.jsx)("img",{src:"".concat(i?".":"","./assets/header-logo.png"),alt:"logo",className:"header-logo"}),Object(L.jsxs)("div",{className:"header-user",children:[a?Object(L.jsx)("img",{src:a,alt:"profile",className:"profile-image"}):Object(L.jsx)($.c,{className:"profile-image"}),Object(L.jsx)("span",{"data-testid":"header-user-name",children:n})]})]}),Object(L.jsx)("nav",{className:"header-nav",children:["Search","Favorites","Profile"].map((function(e,t){var n=e.toLowerCase();return Object(L.jsx)(d.b,{to:"/".concat(n),"data-testid":"link-to-".concat(n),className:s(n),children:e},t)}))})]})})}}]),n}(a.Component),re=(n(42),function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e=[{path:"/search",component:D},{path:"/album/:id",component:Q},{path:"/favorites",component:X},{path:"/profile",component:Y},{path:"/profile/edit",component:ee}];return Object(L.jsx)(d.a,{children:Object(L.jsxs)(j.d,{children:[e.map((function(e,t){var n=e.path,a=e.component;return Object(L.jsxs)(j.b,{exact:!0,path:n,children:[Object(L.jsx)(ae,{currentPage:n}),Object(L.jsx)(j.b,{component:a})]},t)})),Object(L.jsx)(j.b,{exact:!0,path:"/",component:C}),Object(L.jsx)(j.b,{path:"*",component:ne})]})})}}]),n}(a.Component)),ie=re;s.a.render(Object(L.jsx)(r.a.StrictMode,{children:Object(L.jsx)(ie,{})}),document.getElementById("root"))}},[[43,1,2]]]);
//# sourceMappingURL=main.738bd945.chunk.js.map